# Directed Greybox Fuzzing

### Figure 1

```c
1455 + /* Read type and payload length first */
1456 + hbtype = *p++;
1457 + n2s(p, payload);
1458 + pl = p;
· · ·
1465 + if (hbtype == TLS1_HB_REQUEST) {
1477 + /* Enter response type, length and copy payload */
1478 + *bp++ = TLS1_HB_RESPONSE;
1479 + s2n(payload, bp);
1480 + memcpy(bp, pl, payload);
```

> Figure 1: Commit introducing Heartbleed: After reading the
> payload from the incoming message p (1455-8), it copies
> payload many bytes from the incoming to the outgoing message. If payload is set to 64kb and the incoming message is
> one byte long, the sender reveals up to ∼64kb of private data.

### Figure 2

![](http://ww1.sinaimg.cn/large/006AWYXBly1fowitpkcwqj30en099dgc.jpg)



- Generage inputs with the objective of reaching a given set of target program location efficiently.
- assigns more energy to seeds that are closer to the target locations while reducing energy for seeds that are futher away.(simulated annealing-based)
- new inputs are generated by mutating a provided seed input and added to the fuzzer's queue if they exercise a new and interesting path.
- directed symbolic is very effective.
- however the effectiveness of such whitebox fuzzers comes at the cost of efficiency.
- DGF is focused on reaching a given set of target location in a program.
- we cast reachability as an optimization problem and employ a specific meta-heuristic to minimize the distance of the generated seeds to the targets
- the meta-heuristic that DGF employs to minimize seed distance is called simulated annealing and is implemented as power schedule.
- a power schedule controls the energy of all seeds
- a seed's energy specifies the time spent fuzzing the seed.
- a seed's energy specifies the time spent fuzzing the seed.
- Like wth all greybox fuzzing techniques, by moving the analysis to compile-time, we minimize the overhead at runtime.



## To compute seed distance

1. first compute and instrument the distance of each basic block to the targets

   > while seed distance is inter-procedural, our novel measure requires analysis only once for the call graph and once per intra-procedural CFG.

2. at runtime, the fuzzer aggregates the distance values of each exercised basic block to compute the seed distance values of each exercised basic block to compute the seed distance as their mean.

- Directed greybox fuzzing is effectively directed and efficiently complements symbolic execution-based directed fuzzing.
- directed greybox fuzzing is useful in the domains of patch testing and crash reproduction.
- GoAFL is an useful path testing tool that effectively exposes vulnerabilities that were recently introduced and incomplete fixes of previously reported vulnerabilities.
- ​for each target ***t***, KATCH executes the following greedy search: KATCH identifies a seed ***s*** in the regression test suite that is "closest" to ***t***.

